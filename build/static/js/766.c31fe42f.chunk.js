"use strict";(self.webpackChunkoasis_front=self.webpackChunkoasis_front||[]).push([[766],{70766:(e,n,s)=>{s.r(n),s.d(n,{default:()=>v});var a=s(72791),t=s(96172),i=s(87284),o=s(30808),r=s(57689),c=s(85698),l=s(61889),d=s(57621),u=s(53220),m=s(78145),p=s(38314),h=s(32325),x=s(5574),g=s(16029),j=s(65661),b=s(39157),f=s(97123),Z=s(82880),w=s(80184);const P={rows:[],isLoading:!0},S=(0,t.p5)((0,t.Tg)((e=>{let{id:n,doPost:s,doGet:t,genericException:r,appSuccess:c,setOpenModal:l,refreshTable:d}=e;const[u,m]=(0,a.useState)(P),[S,y]=(0,a.useState)([]);(0,a.useEffect)((()=>{(async()=>{const e={url:"".concat(p.Z.seguridad.rolesPermission.getPermission,"/").concat(n)};try{const n=await t(e);m({rows:n,isLoading:!1})}catch(s){r(s)}})()}),[r,n,t]);const{isLoading:C,rows:R}=u,{title:k}=o.default.seguridad.rolPermission;return(0,w.jsx)(x.Z,{open:!0,onClose:l,fullWidth:!0,maxWidth:"lg",children:C?(0,w.jsx)(g.Z,{p:10,children:(0,w.jsx)(i.aN,{})}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(j.Z,{children:k}),(0,w.jsx)(b.Z,{children:(0,w.jsx)(i.iA,{data:R,columns:[{name:"name",label:"Permiso"},{name:"description",label:"Modulo"}],onRowsSelect:e=>{y(e)}})}),(0,w.jsxs)(f.Z,{children:[(0,w.jsx)(Z.Z,{disabled:!(S.length>0),variant:"contained",onClick:async()=>{const e=[];S.forEach((n=>{e.push(n.name)}));const a={url:p.Z.seguridad.rolesPermission.base,data:{roleId:n,permissions:e}};try{await s(a),d(),l(),c(h.Z.crud.new)}catch(t){r(t)}},children:"Seleccionar"}),(0,w.jsx)(Z.Z,{variant:"contained",onClick:l,children:"Cancelar"})]})]})})}))),y=(0,t.p5)((0,t.Tg)((e=>{let{id:n,doDelete:s,appWarning:t,genericException:r}=e;const[c,l]=(0,a.useState)(null),[d,u]=(0,a.useState)(null),[x,g]=(0,a.useState)(!1),j=(0,a.useRef)(null),b=()=>l(null),f=()=>j.current.refresh(),{deleteTitle:Z,deleteMessage:P}=o.default.seguridad.rol,y=[{name:"name",label:"Permiso"},{name:"description",label:"Modulo"},{name:"acciones",label:"Acciones",filter:!1,component:e=>{const{name:n}=e;return(0,w.jsx)(i.Gh,{onDelete:()=>(e=>l(e))(n),row:e})}}];return(0,w.jsxs)(w.Fragment,{children:[Boolean(c)&&(0,w.jsx)(m.s,{open:!0,title:Z,message:P,onClose:b,onAccept:async()=>{const e={url:"".concat(p.Z.seguridad.rolesPermission.base),data:{name:c}};try{await s(e),f(),b(),t(h.Z.crud.delete)}catch(n){r(n)}}}),Boolean(x)&&(0,w.jsx)(S,{id:d,setOpenModal:()=>{g(!1),u(null)},refreshTable:f}),(0,w.jsx)(i.iA,{forwardedRef:j,serverSideUrl:"".concat(p.Z.seguridad.rolesPermission.base,"/").concat(n),serverSideData:{id:n},onCreate:()=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;g(!0),u(e)}(n),columns:y})]})}))),{title:C,updateTitle:R}=o.default.seguridad.rol,k=[{label:"Seguridad"},{label:C}];const v=(0,t.p5)((0,t.Tg)((function(){const{id:e}=(0,r.UO)(),n=[{label:"Permisos",component:(0,w.jsx)(y,{id:e})}];return(0,w.jsxs)(i.cc,{title:R,breadcrumbs:k,withOutCard:!0,children:[(0,w.jsx)(l.ZP,{container:!0,spacing:2,sx:{pb:2,minHeight:250},children:(0,w.jsx)(l.ZP,{item:!0,xs:12,md:12,children:(0,w.jsx)(d.Z,{sx:{p:3,minHeight:"100%"},children:(0,w.jsx)(u.Z,{id:e})})})}),(0,w.jsx)(d.Z,{sx:{pl:2,pr:2},children:(0,w.jsx)(c.Z,{config:n})})]})})))},53220:(e,n,s)=>{s.d(n,{Z:()=>j});var a=s(72791),t=s(61889),i=s(92506),o=s(81724),r=s(87284),c=s(38314),l=s(32325),d=s(96172),u=s(40720),m=s(57689),p=s(80184);const h=o.Ry({}),x=c.Z.seguridad.roles.base;const g={nombre:"",compania_id:1},j=(0,d.p5)((0,d.Tg)((e=>{let{id:n,doGet:s,genericException:o,appSuccess:d,doPost:j,doPut:b,appInfo:f,refresh:Z}=e;const w=(0,m.s0)(),[P,S]=(0,a.useState)(g),y=(0,a.useCallback)((async()=>{const e={url:c.Z.seguridad.roles.initFormComponent,data:n?{id:n}:{}};return await s(e)}),[s,n,Z]),C=(0,a.useCallback)((async()=>{try{const e=await y(),{name:s}=e;S({id:n||null,nombre:s||""})}catch(e){o(e)}}),[o,y]);(0,a.useEffect)((()=>{C()}),[C]);const R=e=>{w("".concat("/app/seguridad/roles","/edit/").concat(e),{replace:!1})},{isLoading:k}=P;return k?(0,p.jsx)(r.aN,{}):(0,p.jsx)(i.J9,{enableReinitialize:!0,initialValues:P,validationSchema:h,onSubmit:async e=>{const s=(e=>{const{nombre:n}=e;return{name:n}})(e),a={url:n?"".concat(x,"/").concat(n):x,data:s},t=n?b:j;try{const e=await t(a);n?(f(l.Z.crud.update),R(e.id)):(d(l.Z.crud.new),R(e.id))}catch(i){console.log("ERROR AL GUARDAR "+i),o(i)}},children:e=>(0,p.jsxs)(i.l0,{children:[(0,p.jsx)(u.Au,{formProps:e}),(0,p.jsx)(t.ZP,{container:!0,direction:"row",spacing:2,children:(0,p.jsx)(t.ZP,{container:!0,item:!0,spacing:2,children:(0,p.jsx)(t.ZP,{item:!0,xs:6,md:6,xl:6,children:(0,p.jsx)(i.gN,{label:"Nombre",name:"nombre",component:r.dn})})})})]})})})))}}]);
//# sourceMappingURL=766.c31fe42f.chunk.js.map