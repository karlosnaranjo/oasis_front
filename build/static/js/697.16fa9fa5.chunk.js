"use strict";(self.webpackChunkoasis_front=self.webpackChunkoasis_front||[]).push([[697],{21498:(e,a,t)=>{t.d(a,{Z:()=>j});var s=t(72791),n=t(61889),r=t(92506),o=t(81724),l=t(87284),c=t(38314),i=t(32325),d=t(96172),u=t(40720),m=t(57689),p=t(82337),g=t(43849),h=t(80184);const x=o.Ry({code:o.Z_().required("Codigo es requerido"),name:o.Z_().required("Nombre fase es requerido"),phase_id:o.Z_().required("Fase es requerido"),status:o.Z_().required("Estado es requerido")}),f=c.Z.masters.targets.base;let b=[];const Z={code:!1,name:!1,phase_id:null,status:1},j=(0,d.p5)((0,d.Tg)((e=>{let{id:a,doGet:t,genericException:o,appSuccess:d,doPost:j,doPut:S,appInfo:w,setEditable:C,viewMode:_,refresh:y}=e;const R=(0,m.s0)(),[E,P]=(0,s.useState)(Z),[v,A]=(0,s.useState)(!0),N=(0,s.useCallback)((async()=>{const e={url:c.Z.masters.targets.initForm,data:a?{id:a}:{}};return await t(e)}),[t,a,y,C]),q=(0,s.useCallback)((async()=>{try{const{targets:e,phase:a}=await N();b=a.map((e=>({value:e.id,label:e.name})));const{code:t,name:s,phase_id:n,status:r}=e;P({code:t||"",name:s||"",phase_id:n||null,status:(0,g.rp)(r)||"Activo"}),A(!1)}catch(e){console.log("ERROR AL INICIAR"+e),o(e)}}),[o,N]);(0,s.useEffect)((()=>{q()}),[q]);const k=e=>{R("".concat("/app/general/masters/targets","/edit/").concat(e),{replace:!1})};return(0,h.jsx)(h.Fragment,{children:v?(0,h.jsx)(p.Z,{p:10,children:(0,h.jsx)(l.aN,{})}):(0,h.jsx)(r.J9,{enableReinitialize:!0,initialValues:E,validationSchema:x,onSubmit:async e=>{const t=(e=>{const{code:a,name:t,phase_id:s,status:n}=e;return{code:a,name:t,phase_id:s,status:(0,g.HY)(n)}})(e),s={url:a?"".concat(f,"/").concat(a):f,data:t},n=a?S:j;try{const e=await n(s);a?(w(i.Z.crud.update),k(e.response.data.id)):(d(i.Z.crud.new),k(e.response.data.id))}catch(r){console.log("ERROR AL GUARDAR "+r),o(r)}},children:e=>(0,h.jsxs)(r.l0,{children:[(0,h.jsx)(u.Au,{formProps:e}),(0,h.jsxs)(n.ZP,{container:!0,direction:"row",spacing:2,children:[(0,h.jsx)(n.ZP,{item:!0,xs:6,md:6,xl:6,children:(0,h.jsx)(r.gN,{label:"Codigo",name:"code",component:l.dn})}),(0,h.jsx)(n.ZP,{item:!0,xs:6,md:6,xl:6,children:(0,h.jsx)(r.gN,{label:"Nombre fase",name:"name",component:l.dn})}),(0,h.jsx)(n.ZP,{item:!0,xs:6,md:6,xl:6,children:(0,h.jsx)(r.gN,{label:"Fase",name:"phase_id",component:l.Ky,items:b})}),(0,h.jsx)(n.ZP,{item:!0,xs:12,md:6,xl:6,children:(0,h.jsx)(r.gN,{label:"Estado",name:"status",component:l.dn,disabled:!0})})]})]})})})})))},1697:(e,a,t)=>{t.r(a),t.d(a,{default:()=>w});var s=t(72791),n=t(57689),r=t(87284),o=t(38314),l=t(32325),c=t(96172),i=t(78145),d=t(30808),u=t(21498),m=t(43849),p=t(80184);const{masters:{targets:{title:g,deleteTitle:h,deleteMessage:x,changeStatusTitle:f,changeStatusMessage:b}}}=d.default,Z="general:masters:targets:create",j="general:masters:targets:delete",S="general:masters:targets:changeStatus",w=(0,c.p5)((0,c.Tg)((e=>{const[a,t]=(0,s.useState)(null),[c,d]=(0,s.useState)(null),[w,C]=(0,s.useState)(null),[_,y]=(0,s.useState)(!1),R=(0,s.useRef)(null);(0,s.useEffect)((()=>{_||t(null)}),[_]);const E=[{label:"masters"},{label:g}],P="/app/general/masters/targets",v=(0,n.s0)(),A=()=>d(null),N=e=>(0,p.jsx)(r.Gh,{row:e,onEdit:()=>{return a=e.id,void v("".concat(P,"/edit/").concat(a),{replace:!0,id:a});var a},onDelete:()=>function(){let{id:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return d(e)}(e),onChangeStatus:()=>C(e.id)}),q=[{name:"code",label:"Codigo"},{name:"name",label:"Nombre fase"},{name:"phase_name",label:"Fase"},{label:"Estado",filter:!1,component:e=>(0,p.jsx)(r.Fm,{estado:(0,m.rp)(e.status)})},{name:"acciones",width:130,align:"right",label:"Acciones",filter:!1,component:e=>N(e)}];return(0,p.jsxs)(r.cc,{breadcrumbs:E,children:[Boolean(c)&&(0,p.jsx)(i.s,{open:!0,title:h,message:x,onClose:A,onAccept:async()=>{const a="".concat(o.Z.masters.targets.base,"/").concat(c);try{await e.doDelete({url:a}),R.current.refresh(),A(),e.appWarning(l.Z.crud.delete)}catch(t){e.appError(l.Z.crud.fail)}finally{d(null)}},createPermissions:j}),Boolean(w)&&(0,p.jsx)(i.s,{open:!0,title:f,message:b,onClose:()=>C(null),onAccept:()=>(async()=>{const a="".concat(o.Z.masters.targets.base,"/changestatus/").concat(w);try{await e.doPut({url:a}),e.appWarning(l.Z.crud.changeStatus),R.current.refresh()}catch(t){e.appError(l.Z.crud.fail)}finally{C(null)}})(),createPermissions:S}),_&&(0,p.jsx)(u.Z,{id:a,setOpenModal:y,refreshData:R}),(0,p.jsx)(r.iA,{forwardedRef:R,onCreate:()=>{v("".concat(P,"/new"),{replace:!1})},serverSideUrl:o.Z.masters.targets.base,columns:q,title:g,createPermissions:Z})]})})))},82337:(e,a,t)=>{t.d(a,{Z:()=>o});var s=t(33359),n=t(23814);const r=(0,t(59703).Z)("MuiBox",["root"]),o=(0,n.Z)({defaultClassName:r.root,generateClassName:s.Z.generate})}}]);
//# sourceMappingURL=697.16fa9fa5.chunk.js.map