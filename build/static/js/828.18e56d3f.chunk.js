"use strict";(self.webpackChunkoasis_front=self.webpackChunkoasis_front||[]).push([[828],{46232:(e,a,t)=>{t.d(a,{Z:()=>E});var n=t(72791),s=t(61889),i=t(92506),r=t(81724),l=t(87284),c=t(38314),o=t(32325),d=t(96172),u=t(40720),m=t(57689),p=t(82337),g=t(43849),x=t(92983),_=t(80184);const h=r.Ry({code:r.Z_().required("Codigo es requerido"),patient_id:r.Z_().required("Paciente es requerido"),creation_date:r.Z_().required("Fecha de Creacion es requerido"),phase_id:r.Z_().required("Fase es requerido"),target_id:r.Z_().required("Objetivo es requerido"),start_date:r.Z_().required("Fecha inicio es requerido"),end_date:r.Z_().required("Fecha final es requerido"),clinical_team:r.Z_().required("Apreciacion Equipo Clinico es requerido"),achievement:r.Z_().required("Logros y Dificultades es requerido"),strategy:r.Z_().required("Estrategias Utilizadas es requerido"),requirement:r.Z_().required("Exigencias es requerido"),test:r.Z_().required("Evaluaci\xf3n es requerido"),status:r.Z_().required("Estado es requerido")}),b=c.Z.transactions.evaluations.base,Z="".concat(b,"/targets-by-phase");let j=[],v=[],q=[],f=[{label:"Positivo",value:"Positivo"},{label:"Negativo",value:"Negativo"},{label:"Observacion",value:"Observacion"}];const y={code:!1,patient_id:null,creation_date:!1,phase_id:null,target_id:null,start_date:!1,end_date:!1,clinical_team:!1,achievement:!1,strategy:!1,requirement:!1,test:"",status:1},P=e=>e.map((e=>({value:e.id,label:e.name}))),E=(0,d.p5)((0,d.Tg)((e=>{let{id:a,doGet:t,genericException:r,appSuccess:d,doPost:E,doPut:w,appInfo:C,setEditable:N,viewMode:R,refresh:A}=e;const F=(0,m.s0)(),[O,S]=(0,n.useState)(y),[I,k]=(0,n.useState)(!0),W=(0,n.useCallback)((async()=>{const e={url:c.Z.transactions.evaluations.initForm,data:a?{id:a}:{}};return await t(e)}),[t,a,A,N]),D=(0,n.useCallback)((async()=>{try{const{evaluations:e,patient:a,phase:t,target:n}=await W();j=P(a),v=P(t),q=P(n);const{code:s,patient_id:i,creation_date:r,phase_id:l,target_id:c,start_date:o,end_date:d,clinical_team:u,achievement:m,strategy:p,requirement:x,test:_,status:h}=e;S({code:s||"Autom\xe1tico",patient_id:i||null,creation_date:r||"",phase_id:l||null,target_id:c||null,start_date:o||"",end_date:d||"",clinical_team:u||"",achievement:m||"",strategy:p||"",requirement:x||"",test:_||"",status:(0,g.rp)(h)||"Activo"}),k(!1)}catch(e){console.log("ERROR AL INICIAR"+e),r(e)}}),[r,W]);(0,n.useEffect)((()=>{D()}),[D]);const L=e=>{F("".concat("/app/general/transactions/evaluations","/edit/").concat(e),{replace:!1})};return(0,_.jsx)(_.Fragment,{children:I?(0,_.jsx)(p.Z,{p:10,children:(0,_.jsx)(l.aN,{})}):(0,_.jsx)(i.J9,{enableReinitialize:!0,initialValues:O,validationSchema:h,onSubmit:async e=>{const t=(e=>{const{code:a,patient_id:t,creation_date:n,phase_id:s,target_id:i,start_date:r,end_date:l,clinical_team:c,achievement:o,strategy:d,requirement:u,test:m,status:p}=e;return{code:a,patient_id:t,creation_date:n,phase_id:s,target_id:i,start_date:r,end_date:l,clinical_team:c,achievement:o,strategy:d,requirement:u,test:m,status:(0,g.HY)(p)}})(e),n={url:a?"".concat(b,"/").concat(a):b,data:t},s=a?w:E;try{const e=await s(n);a?(C(o.Z.crud.update),L(e.response.data.id)):(d(o.Z.crud.new),L(e.response.data.id))}catch(i){console.log("ERROR AL GUARDAR "+i),r(i)}},children:e=>(0,_.jsxs)(i.l0,{children:[(0,_.jsx)(u.Au,{formProps:e}),(0,_.jsxs)(s.ZP,{container:!0,direction:"row",spacing:2,children:[(0,_.jsx)(s.ZP,{item:!0,xs:6,md:6,xl:6,children:(0,_.jsx)(i.gN,{label:"Codigo",name:"code",component:l.dn,disabled:!0,InputProps:{readOnly:!0}})}),(0,_.jsx)(s.ZP,{item:!0,xs:6,md:6,xl:6,children:(0,_.jsx)(i.gN,{label:"Paciente",name:"patient_id",component:l.Ky,items:j})}),(0,_.jsx)(s.ZP,{item:!0,xs:6,md:6,xl:6,children:(0,_.jsx)(i.gN,{label:"Fecha de Creacion",name:"creation_date",component:x.Z})}),(0,_.jsx)(s.ZP,{item:!0,xs:6,md:6,xl:6,children:(0,_.jsx)(i.gN,{label:"Fase",name:"phase_id",component:l.Ky,items:v,onOptionSelected:a=>(async(e,a)=>{try{if(e){const n={url:Z,data:{phase_id:e}},s=await t(n);q=P(s.targets),a.setFieldValue("target_id",null)}else q=[],a.setFieldValue("target_id",null)}catch(n){console.log("ERROR AL CARGAR OBJETIVOS "+n),r(n)}})(a,e)})}),(0,_.jsx)(s.ZP,{item:!0,xs:6,md:6,xl:6,children:(0,_.jsx)(i.gN,{label:"Objetivo",name:"target_id",component:l.Ky,items:q})}),(0,_.jsx)(s.ZP,{item:!0,xs:6,md:6,xl:6,children:(0,_.jsx)(i.gN,{label:"Fecha inicio",name:"start_date",component:x.Z})}),(0,_.jsx)(s.ZP,{item:!0,xs:6,md:6,xl:6,children:(0,_.jsx)(i.gN,{label:"Fecha final",name:"end_date",component:x.Z})}),(0,_.jsx)(s.ZP,{item:!0,xs:6,md:6,xl:12,children:(0,_.jsx)(i.gN,{label:"Apreciaci\xf3n Equipo Clin\xedco",name:"clinical_team",component:l.OW,rows:8})}),(0,_.jsx)(s.ZP,{item:!0,xs:6,md:6,xl:12,children:(0,_.jsx)(i.gN,{label:"Logros y Dificultades",name:"achievement",component:l.OW,rows:8})}),(0,_.jsx)(s.ZP,{item:!0,xs:6,md:6,xl:12,children:(0,_.jsx)(i.gN,{label:"Estrategias Utilizadas",name:"strategy",component:l.OW,rows:8})}),(0,_.jsx)(s.ZP,{item:!0,xs:6,md:6,xl:12,children:(0,_.jsx)(i.gN,{label:"Exigencias",name:"requirement",component:l.OW,rows:8})}),(0,_.jsx)(s.ZP,{item:!0,xs:12,md:6,xl:6,children:(0,_.jsx)(i.gN,{label:"Evaluacion",name:"test",component:l.Ky,items:f})}),(0,_.jsx)(s.ZP,{item:!0,xs:12,md:6,xl:6,children:(0,_.jsx)(i.gN,{label:"Estado",name:"status",component:l.dn,disabled:!0})})]})]})})})})))},62828:(e,a,t)=>{t.r(a),t.d(a,{default:()=>f});var n=t(72791),s=t(57689),i=t(87284),r=t(38314),l=t(32325),c=t(96172),o=t(78145),d=t(30808),u=t(46232),m=t(43849),p=t(93044),g=t(80184);const{transactions:{evaluations:{title:x,deleteTitle:_,deleteMessage:h,changeStatusTitle:b,changeStatusMessage:Z}}}=d.default,j="general:transactions:evaluations:create",v="general:transactions:evaluations:delete",q="general:transactions:evaluations:changeStatus",f=(0,c.p5)((0,c.Tg)((e=>{const[a,t]=(0,n.useState)(null),[c,d]=(0,n.useState)(null),[f,y]=(0,n.useState)(null),[P,E]=(0,n.useState)(!1),w=(0,n.useRef)(null);(0,n.useEffect)((()=>{P||t(null)}),[P]);const C=[{label:"transactions"},{label:x}],N="/app/general/transactions/evaluations",R=(0,s.s0)(),A=()=>d(null),F=e=>(0,g.jsx)(i.Gh,{row:e,onEdit:()=>{return a=e.id,void R("".concat(N,"/edit/").concat(a),{replace:!0,id:a});var a},onChangeStatus:()=>y(e.id)}),O=[{name:"image",label:"Imagen",component:e=>(0,g.jsx)(p.Z,{alt:e.name,src:e.image,style:{width:"50px",height:"50px"}})},{name:"patient_name",label:"Paciente"},{name:"creation_date",label:"Fecha de Creacion"},{name:"phase_name",label:"Fase"},{name:"target_name",label:"Objetivo"},{name:"start_date",label:"Fecha inicio"},{name:"end_date",label:"Fecha final"},{name:"test",label:"Evaluacion"},{label:"Estado",filter:!1,component:e=>(0,g.jsx)(i.Fm,{estado:(0,m.rp)(e.status)})},{name:"acciones",width:130,align:"right",label:"Acciones",filter:!1,component:e=>F(e)}];return(0,g.jsxs)(i.cc,{breadcrumbs:C,children:[Boolean(c)&&(0,g.jsx)(o.s,{open:!0,title:_,message:h,onClose:A,onAccept:async()=>{const a="".concat(r.Z.transactions.evaluations.base,"/").concat(c);try{await e.doDelete({url:a}),w.current.refresh(),A(),e.appWarning(l.Z.crud.delete)}catch(t){e.appError(l.Z.crud.fail)}finally{d(null)}},createPermissions:v}),Boolean(f)&&(0,g.jsx)(o.s,{open:!0,title:b,message:Z,onClose:()=>y(null),onAccept:()=>(async()=>{const a="".concat(r.Z.transactions.evaluations.base,"/changestatus/").concat(f);try{await e.doPut({url:a}),e.appWarning(l.Z.crud.changeStatus),w.current.refresh()}catch(t){e.appError(l.Z.crud.fail)}finally{y(null)}})(),createPermissions:q}),P&&(0,g.jsx)(u.Z,{id:a,setOpenModal:E,refreshData:w}),(0,g.jsx)(i.iA,{forwardedRef:w,onCreate:()=>{R("".concat(N,"/new"),{replace:!1})},serverSideUrl:r.Z.transactions.evaluations.base,columns:O,title:x,createPermissions:j})]})})))},82337:(e,a,t)=>{t.d(a,{Z:()=>r});var n=t(33359),s=t(23814);const i=(0,t(59703).Z)("MuiBox",["root"]),r=(0,s.Z)({defaultClassName:i.root,generateClassName:n.Z.generate})}}]);
//# sourceMappingURL=828.18e56d3f.chunk.js.map